# OOP2 第 11 回レポート

学籍番号: k24027
<br />
名前: 内田晏大朗

### 1. データ登録アプリケーションにて登録するデータと集計しトップページに載せる情報の詳細

表示するデータ
月毎の貸し出し数

貸し出しランキング

図書館ユーザー登録数の推移


### 2. 自分が担当した部分の説明

自分が担当したのは図書館管理システムのユーザー登録者数を月毎の累積でグラフ表示する部分を担当した。

#### データの形式・データ型
ユーザーデータは Peewee ORM を用いて管理しており、主なカラム構成は以下の通りである。

| カラム名 | データ型 | 内容 |
|--------|---------|------|
| id | IntegerField | ユーザーID（主キー） |
| name | CharField | 利用者名 |
| age | IntegerField | 年齢 |
| created_at | DateTimeField | 登録日時（自動取得） |

登録日時（`created_at`）は、ユーザー登録時に `datetime.now()` を用いて**自動的に現在時刻を保存**する仕様とし、ユーザー登録画面からは日時を変更できないようにした。

### 集計条件・出力方法  
トップページでは、以下の条件でユーザー登録数を集計している。
 
- 集計単位：月ごとの登録者数  
- 表示方法：月別登録者数の**累計値**

Peewee の `fn.strftime` と `COUNT` を用いて月別登録数を集計し、1月〜12月までのラベルを作成した。  
存在しない月は 0 人として扱い、累計値を計算している。  
集計結果は `labels`（年月）と `counts`（累計登録者数）としてテンプレートに渡し、Chart.js により折れ線グラフとしてトップページに表示している。

### 使用したライブラリ・技術
- Flask（Web フレームワーク）
- Peewee（ORM）
- Jinja2（テンプレートエンジン）
- Chart.js（グラフ描画ライブラリ）
- SQLite（データベース）


### 作成した Pull Request  
ユーザー管理機能およびトップページへのグラフ統合を実装した Pull Request は以下である。

- Pull Request URL  
  https://github.com/OOP2-2025-final-G11/LibraryManagementSystem/pull/11


### 3. レビューを行ったグループメンバーのPullRequestのURL（リーダーもここは書いてください）
自分の作業に時間がかかって他の人のPullRequestをレビューできなかった。

### 4. ある程度のデータ登録がされた状態での画面のスクリーンショット

![alt text](<スクリーンショット 2025-12-24 22.56.21.png>)

![alt text](<スクリーンショット 2025-12-24 22.56.34.png>)

![alt text](<スクリーンショット 2025-12-24 22.56.40.png>)

![alt text](<スクリーンショット 2025-12-24 22.56.55.png>)

### 5. 感想

今回の開発を通して、Flask における Blueprint を用いた役割分担の重要性を強く感じた。一方で、テンプレート側で変数が未定義のまま使用されるとエラーが発生するなど、バックエンドとフロントエンドの連携の難しさも実感した。
また、レビューを通じて他メンバーの実装方法を学ぶことができると思うため、今後は積極的にコードレビューに参加したい。