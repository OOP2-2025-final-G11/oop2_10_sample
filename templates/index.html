<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>注文管理システム</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='base-style.css') }}"
    />
  </head>
  <body>
    <h1>注文管理システム</h1>
    <ul>
      <li><a href="{{ url_for('user.list') }}">ユーザー（利用者）</a></li>
      <li><a href="{{ url_for('books.list') }}">本一覧</a></li>
      <li><a href="{{ url_for('rental.list') }}">本の貸し出し</a></li>
      <li><a href="{{ url_for('book_request.list') }}">本のリクエスト</a></li>
    </ul>
    <hr />

    <h2>月ごとの貸出数</h2>
    <p id="chart-year" class="chart-year"></p>
    <canvas id="monthlyRentalChart" width="600" height="300"></canvas>

    <script>
      fetch("/rentals/api/monthly_rentals")
        .then((res) => res.json())
        .then((result) => {

          document.getElementById("chart-year").textContent =
        result.year + "年";
          const ctx = document.getElementById("monthlyRentalChart");

          new Chart(ctx, {
            type: "bar",
            data: {
              labels: result.labels,
              datasets: [
                {
                  label: "貸出数",
                  data: result.data,
                },
              ],
            },
            options: {
              responsive: true,
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });
        });
    </script>
  </body>
</html>
