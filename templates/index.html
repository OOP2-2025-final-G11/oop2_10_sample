<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>æ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='base-style.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <h1>æ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
    <ul>
      <li><a href="{{ url_for('user.list') }}">ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆåˆ©ç”¨è€…ï¼‰</a></li>
      <li><a href="{{ url_for('books.list') }}">æœ¬ä¸€è¦§</a></li>
      <li><a href="{{ url_for('rental.list') }}">æœ¬ã®è²¸ã—å‡ºã—</a></li>
      <li><a href="{{ url_for('book_request.list') }}">æœ¬ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</a></li>
    </ul>

    <hr />

    <h2>ğŸ“Š è²¸å‡ºãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>

    <canvas id="rentalChart"></canvas>

    <script>
      fetch("/api/rental-ranking")
        .then((res) => res.json())
        .then((json) => {
          const ctx = document.getElementById("rentalChart");

          // é †ä½ï¼‹æœ¬ã‚¿ã‚¤ãƒˆãƒ«ã‚’ xè»¸ã«è¡¨ç¤º
          const xLabels = json.labels.map(
            (title, i) => `${i + 1}ä½\n${title}`
          );

          new Chart(ctx, {
            type: "bar",
            data: {
              labels: xLabels,
              datasets: [
                {
                  label: "è²¸å‡ºå›æ•°",
                  data: json.data,
                },
              ],
            },
            options: {
              plugins: {
                legend: {
                  display: false,
                },
              },
              scales: {
                x: {
                  ticks: {
                    autoSkip: false, // â† å…¨éƒ¨è¡¨ç¤ºï¼ˆé‡è¦ï¼‰
                  },
                  title: {
                    display: true,
                    text: "é †ä½ï¼ˆæœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«ï¼‰",
                  },
                },
                y: {
                  beginAtZero: true,
                  title: {
                    display: true,
                    text: "è²¸å‡ºå›æ•°",
                  },
                },
              },
            },
          });
        });
    </script>
  </body>
</html>
